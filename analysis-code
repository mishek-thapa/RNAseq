RUNNING RNAseq software

#FASTQC
# Run a fastqc report on all files in the directory.
cd ~/edu/lec7 #go to directory
fastqc *.fastq #run fastqc on all fastq files in the directory

#runFASTQC using parallel computing and then mv the files
find /mnt/Alma/Data/RNAseq/flowcell/ -name '*.fastq.gz' | awk '{printf("fastqc \"%s\"\n", $0)}' | parallel -j 10 —verbose

#move fast q reports
 find /mnt/Alma/Data/RNAseq/flowcell/ -name '*fastqc.*' | xargs -I '{}' mv '{}' /mnt/Alma/Data/RNAseq/flowcell/rawFastqc_reports



#Trimmomatic 
# Trimmomatic uses a different set of paramters and philosophy. Parameters need to be space separated words
# where the sub-parameters  are separated by a colon. Basically they invented their own parameter formats.
#Really DUMB
trimmomatic SE -phred33 ~/Desktop/rnaseq/data/SRR519926_1.fastq ~/Desktop/rnaseq/results/trimmomatic_1.fq SLIDINGWINDOW:4:30 MINLEN:35 TRAILING:3
trimmomatic PE -phred33 SRR519926_1_R1.fastq SRR519926_1_R2.fastq trimmomatic_R1.fq trimmomatic_R2.fq SLIDINGWINDOW:4:30 MINLEN:35 TRAILING:3

#Run Trimmomatic across all files in a folder

cd desktop/rnaseq/data
for f in $(ls *.fastq.gz | sed 's/?_001.fastq.gz//' | sort -u)
do
trimmoomatic PE -phred33 ${f}1_001.fastq.gz ${f}1_002.fastq.gz  ${f}_R1_paired.fq.gz ${f}1_unpaired.fq.gz ${f}_R2_paired.fq.gz ${f}2_unpaired.fq.gz LEADING:3 TRAILING:3 SLIDINGWINDOW:4:15 MINLEN:35
done

find /desktop/rnaseq/data/ -name ‘*paired.fq.gz' | xargs -I '{}' mv '{}' /desktop/rnaseq/data/trimmomatic



#Fastqc Redo FASTQC on the trimmed samples 
fastqc trimmed-*.fastq






#STAR Analysis

#Create a genome that STAR can use; this only has to be done once
#combine a genome with the annotations that describe where the genes are; source: https://www.ncbi.nlm.nih.gov/assembly/GCF_000001635.27

STAR --runThreadN {number of cores} --runMode genomeGenerate --genomeDir /path/to/resulting/STAR/genome/ --genomeFastaFiles /path/to/genome/fasta/file --sjdbGTFfile /path/to/GTF/or/GFF --sjdbOverhang {read length - 1}
STAR --runThreadN 8 --runMode genomeGenerate --genomeDir /Desktop/rnaseq/genome/star/genome/ --genomeFastaFiles /Desktop/rnaseq/genome/*.fna --sjdbGTFfile /Desktop/rnaseq/genome/*.gff --sjdbOverhang 50





#Alignment

#Now we can finally align our reads to the genome

STAR --runMode alignReads --outSAMtype BAM Unsorted --readFilesCommand zcat --genomeDir /path/to/STAR/genome/folder --outFileNamePrefix {sample name}  --readFilesIn  /path/to/R1 /path/to/R2
STAR --runMode alignReads --outSAMtype BAM Unsorted --readFilesCommand zcat --genomeDir /Desktop/rnaseq/genome/STAR/genome/ --outFileNamePrefix aligned  --readFilesIn  /desktop/rnaseq/data/trimmomatic/R1 /desktop/rnaseq/data/trimmomatic/R2

#STAR on Multiple Reads
cd desktop/rnaseq/results/trimmomatic
for i in *paired_R1.fq.gz; do
STAR --runMode alignReads --genomeLoad  LoadAndKeep --readFilesCommand zcat --outSAMtype BAM Unsorted --genomeDir /Desktop/rnaseq/genome/star/genome --readFilesIn $i ${i%_paired_R1.fq.gz}_R2.fq.gz --runThreadN 8 --outFileNamePrefix ${I%paired_R1.fq.gz}
done





